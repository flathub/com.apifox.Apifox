app-id: com.apifox.Apifox
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
command: apifox
base: org.electronjs.Electron2.BaseApp
base-version: '25.08'
separate-locales: false
finish-args:
  - --share=ipc
  - --share=network
  - --socket=x11
  - --device=dri
modules:
  - name: apifox
    buildsystem: simple
    build-commands:
      - install -Dm644 com.apifox.Apifox.metainfo.xml -t $FLATPAK_DEST/share/metainfo
      - install -Dm644 com.apifox.Apifox.desktop /app/share/applications/com.apifox.Apifox.desktop
      - install -Dm644 com.apifox.Apifox.png /app/share/icons/hicolor/256x256/apps/com.apifox.Apifox.png
      - install -Dm755 apifox.sh /app/bin/apifox
      - install -Dm755 apply_extra ${FLATPAK_DEST}/bin/apply_extra
    sources:
      - type: script
        commands:
          - unzip -q apifox.zip
          - bsdtar -O -xf apifox*.deb data.* | bsdtar --no-same-owner -xf -
          - mv opt/Apifox .
          - rm -rf apifox.zip apifox*.deb opt usr
        dest-filename: apply_extra
      - type: file
        path: com.apifox.Apifox.desktop
      - type: file
        path: com.apifox.Apifox.metainfo.xml
      - type: file
        path: com.apifox.Apifox.png
      - type: file
        path: apifox.sh
      - type: extra-data
        filename: apifox.zip
        only-arches:
          - x86_64
        url: https://file-assets.apifox.com/download/Apifox-linux-deb-latest.zip
        sha256: e1a2dfd2be1eba38318d7b860ad69d02c9db7509f7e215dd064b5c62599aa3f6
        size: 146273049
        x-checker-data:
          type: rotating-url
          url: https://file-assets.apifox.com/download/Apifox-linux-deb-latest.zip
      - type: extra-data
        filename: apifox.zip
        only-arches:
          - aarch64
        url: https://file-assets.apifox.com/download/Apifox-linux-arm64-deb-latest.zip
        sha256: fd57f6e3bf19b928208cc6e526f87162ff73a72064ab4ea83d0c00327e1f2b3e
        size: 124657427
        x-checker-data:
          type: rotating-url
          url: https://file-assets.apifox.com/download/Apifox-linux-arm64-deb-latest.zip
